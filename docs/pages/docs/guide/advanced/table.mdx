import { Callout, Steps } from 'nextra/components'

# 渲染表格

## GFM 语法

建议使用 [GFM 语法](https://github.github.com/gfm/#tables-extension-) 在 Markdown 中编写表格。

```mdx filename="Markdown"
| left   | center | right |
| :----- | :----: | ----: |
| foo    |  bar   |   baz |
| banana | apple  |  kiwi |
```

将会被渲染为：

| left   | center | right |
| :----- | :----: | ----: |
| foo    |  bar   |   baz |
| banana | apple  |  kiwi |

## 用 HTML 编写表格

如果你尝试渲染下面这个直接用 HTML 写成的 `<table />{:jsx}` 元素

```mdx filename="Markdown"
<table>
  <thead>
    <tr>
      <th>left</th>
      <th align="center">center</th>
      <th align="right">right</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td align="center">bar</td>
      <td align="right">baz</td>
    </tr>
    <tr>
      <td>banana</td>
      <td align="center">apple</td>
      <td align="right">kiwi</td>
    </tr>
  </tbody>
</table>
```

你会获得如下的结果：

<table>
  <thead>
    <tr>
      <th>left</th>
      <th align="center">center</th>
      <th align="right">right</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td align="center">bar</td>
      <td align="right">baz</td>
    </tr>
    <tr>
      <td>banana</td>
      <td align="center">apple</td>
      <td align="right">kiwi</td>
    </tr>
  </tbody>
</table>

<Callout type="warning">
  对于没有样式的结果感到困惑？我们在[这里](#why-this-happens)解释了原因。
</Callout>

## 动态表格

### 如何书写？

想要渲染动态表格吗？您可以通过在表格中嵌入 JavaScript 表达式来实现：

```mdx filename="Markdown"
<table>
  <thead>
    <tr>
      <th>国家</th>
      <th>国旗</th>
    </tr>
  </thead>
  <tbody>
    {[
      { country: '法国', flag: '🇫🇷' },
      { country: '乌克兰', flag: '🇺🇦' }
    ].map(item => (
      <tr key={item.country}>
        <td>{item.country}</td>
        <td>{item.flag}</td>
      </tr>
    ))}
  </tbody>
</table>
```

会被渲染为：

<table>
  <thead>
    <tr>
      <th>国家</th>
      <th>国旗</th>
    </tr>
  </thead>
  <tbody>
    {[
      { country: '法国', flag: '🇫🇷' },
      { country: '乌克兰', flag: '🇺🇦' }
    ].map(item => (
      <tr key={item.country}>
        <td>{item.country}</td>
        <td>{item.flag}</td>
      </tr>
    ))}
  </tbody>
</table>

<Callout type="warning">
  对无样式的元素感到困惑?我们在下面👇解释了为什么会发生这种情况。
</Callout>

### 令人意外的结果

与 [GFM 语法表格](#gfm-syntax)相比，表格看起来有所不同：

1. 只有表格主体 `<tbody />{:jsx}` 的子元素被应用了样式

2. 表头没有样式

3. 表格没有上边距

### 为什么会这样

MDX2 不会用 `<MDXProvider />{:jsx}` 替换直接用 HTML 语言书写的元素。

Tailwind CSS 的创建者 Adam Wathan 在 MDX2 中提交了一个[问题](https://github.com/mdx-js/mdx/issues/821)，希望能有一个“逃生舱口”，我们可以这样命名：

> 请仅转换 Markdown 标签，而不是直接的 HTML 标签

由于表头没有被 Nextra 的 MDX 组件 `<tr />{:jsx}`、`<th />{:jsx}` 和 `<td />{:jsx}` 替换，所以看起来没有样式。同样地，直接的 `<table />{:jsx}` 也没有被替换，因此没有默认的上边距 `mt-6`。

### 解决方法

#### 一次性修复

只需用花括号 `{` 和 `}` 包裹您的表格，例如：

```text filename="Markdown"
{<table>
  ...
</table>}
```

#### 更改默认行为

如果您仍然对此感到困惑，并且希望为表格使用常规的直接 HTML 元素，请执行以下操作：

<Steps>
### 安装 `remark-mdx-disable-explicit-jsx` 包

```sh npm2yarn
npm i remark-mdx-disable-explicit-jsx
```

### 设置

在 next.config.mjs 文件中的 nextra 函数中配置插件

```js filename="next.config.mjs" {2,8-13}
import nextra from 'nextra'
import remarkMdxDisableExplicitJsx from 'remark-mdx-disable-explicit-jsx'

const withNextra = nextra({
  theme: 'nextra-theme-docs',
  themeConfig: './theme.config.tsx',
  mdxOptions: {
    remarkPlugins: [
      [
        remarkMdxDisableExplicitJsx,
        { whiteList: ['table', 'thead', 'tbody', 'tr', 'th', 'td'] }
      ]
    ]
  }
})

export default withNextra()
```

</Steps>
